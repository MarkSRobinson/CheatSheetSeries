# `Cross-Organization mTLS` Cheat Sheet

**Replace `Topic` with the topic you're tackling, such as `Authentication` and remove this line**

```markdown
# Mandatory Markdown Format Rules

**!!! REMOVE THIS BLOCK BEFORE TO SUBMIT YOUR CHEAT SHEET VIA PULL REQUEST !!!**

- Use this [editor and validation policy](https://github.com/OWASP/CheatSheetSeries#editor--validation-policy).
- Use these [format rules](https://github.com/OWASP/CheatSheetSeries#conversion-rules).
```

## Introduction

Many large organizations setup up mTLS to ensure that they are connecting to the right hosts. However, there is very little documentation on how to do this correctly, in a way that will support their security and operational goals.

## What is mTLS?

## What are the public root certificate authorities?

## How are certificates Validated?

## How to build a secure mTLS system

### Create a Private CA
 - Use AWS Private CA
 - Use Step-CA

### Create a Root certificate
 - Validity period of 7 years
 - Refer to X for key-length
 - Lock it up in an HSM
 - Lock it to your domain with Name Constraint

### Create intermediate certificates
 - Should have a lifetime of 3 years

### Generate leaf certs
 - Short lived
 - Max 90 days life-time
 - Use a tool like ACME/Certbot to keep them updated

## Distributing root certs

- Put them on the web
-- URL certs.<domain>.<tld>/certs.zip
   These certs are valid and can be used to provide signing. These URLs are protected with regular TLS certificates signed by public CAs
-- URL certs.<domain>.<tld>/old-certs.zip
   These certs are expired/retired and are only of interest for historical reasons.
-- URL certs-private.<domain>.<tld>/certs.zip - Same as certs.<domain>.<tld>/certs.zip but TLS cert is signed by one of the certs in the bundle.

## Rotating certs

Certificates must rotated out periodically. Place new root certs into <Location> for at least 6 months before using them to issue new certificates.

On the flip-side, clients must update their root-CA DB periodically. They must fetch a new bundle at least once in any given 90 day period. The root bundle may only be cache for 30 days.

Root bundles may not be emailed. Emailing certificates is a form certificate pinning (strongly discouraged) and provides a vector for attackers to disrupt your network.


## Checklist

[] Private CA for root certificates w/ HSM
[] 

## References

Any useful references to other useful resources that aren't linked inline elsewhere in the cheat sheet.
